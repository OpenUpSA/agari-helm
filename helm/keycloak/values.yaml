replicaCount: 1

image:
  repository: quay.io/keycloak/keycloak
  pullPolicy: IfNotPresent
  tag: "26.3.2"

nameOverride: ""
fullnameOverride: "keycloak"

service:
  type: ClusterIP
  port: 8080

ingress:
  enabled: true
  className: "nginx"
  annotations:
    nginx.ingress.kubernetes.io/proxy-buffer-size: "128k"
    nginx.ingress.kubernetes.io/proxy-buffering: "on"
    nginx.ingress.kubernetes.io/proxy-buffers-number: "20"
  hosts:
    - host: keycloak.local
      paths:
        - path: /
          pathType: Prefix
  tls: []

extraEnv:
  - name: KC_FEATURES
    value: "preview"
  - name: JAVA_OPTS_APPEND
    value: "-Djava.awt.headless=true -Djboss.modules.system.pkgs=org.jboss.byteman -Djava.net.preferIPv4Stack=true -server -Xms512m -Xmx768m -XX:+UseG1GC"

probes:
  liveness:
    enabled: false
  readiness:
    enabled: true
    tcpSocket:
      port: 8080
    initialDelaySeconds: 90 
    periodSeconds: 15
    timeoutSeconds: 10
    failureThreshold: 8

keycloak:
  database:
    vendor: postgres
    host: keycloak-db
    port: 5432
    database: keycloakDb
    username: admin
    password: keycloak-db-pass-123
  
  # Admin user
  admin:
    username: admin
    password: admin123
  
  # Keycloak settings
  hostname: keycloak.local
  healthEnabled: true
  startupMode: start-dev
  importRealm: true

# Resource limits - better configuration from values-keycloak.yaml
resources:
  limits:
    cpu: 300m
    memory: 768Mi
  requests:
    cpu: 100m
    memory: 384Mi

# Node selection
nodeSelector: {}
tolerations: []
affinity: {}

# Pod security context
podSecurityContext: {}
securityContext: {}

# Service account
serviceAccount:
  create: true
  annotations: {}
  name: ""

# Pod annotations
podAnnotations: {}

# Autoscaling (disabled by default)
autoscaling:
  enabled: false
  minReplicas: 1
  maxReplicas: 100
  targetCPUUtilizationPercentage: 80
